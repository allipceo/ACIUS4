// ë¬¸ì œí’€ì´ ì—°ê²° í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
// ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ Consoleì—ì„œ ì‹¤í–‰

console.log("ğŸ” AICU ë¬¸ì œí’€ì´ API ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...");

// 1. API Health Check
async function testAPIHealth() {
    try {
        const response = await fetch('/api/quiz/health');
        const data = await response.json();
        console.log("âœ… API Health Check:", data);
        return true;
    } catch (error) {
        console.log("âŒ API Health Check ì‹¤íŒ¨:", error);
        return false;
    }
}

// 2. í€´ì¦ˆ ì„¸ì…˜ ì‹œì‘ í…ŒìŠ¤íŠ¸
async function testQuizStart() {
    try {
        const response = await fetch('/api/quiz/start', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                user_id: 'test_user',
                mode: 'basic',
                category: 'all'
            })
        });
        const data = await response.json();
        console.log("âœ… í€´ì¦ˆ ì„¸ì…˜ ì‹œì‘:", data);
        return data.session_id;
    } catch (error) {
        console.log("âŒ í€´ì¦ˆ ì„¸ì…˜ ì‹œì‘ ì‹¤íŒ¨:", error);
        return null;
    }
}

// 3. ì²« ë²ˆì§¸ ë¬¸ì œ ì¡°íšŒ í…ŒìŠ¤íŠ¸
async function testGetQuestion(sessionId) {
    try {
        const response = await fetch(`/api/quiz/question/${sessionId}/0`);
        const data = await response.json();
        console.log("âœ… ë¬¸ì œ ì¡°íšŒ ì„±ê³µ:", data);
        return data;
    } catch (error) {
        console.log("âŒ ë¬¸ì œ ì¡°íšŒ ì‹¤íŒ¨:", error);
        return null;
    }
}

// 4. ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
async function runFullTest() {
    console.log("ğŸš€ ì „ì²´ API í…ŒìŠ¤íŠ¸ ì‹œì‘...");
    
    // Step 1: Health Check
    const healthOK = await testAPIHealth();
    if (!healthOK) {
        console.log("ğŸš¨ API ì„œë²„ ì—°ê²° ì‹¤íŒ¨ - app_v2.0.py ì¬ì‹œì‘ í•„ìš”");
        return;
    }
    
    // Step 2: ì„¸ì…˜ ì‹œì‘
    const sessionId = await testQuizStart();
    if (!sessionId) {
        console.log("ğŸš¨ í€´ì¦ˆ ì„¸ì…˜ ìƒì„± ì‹¤íŒ¨ - Week2 API ì—°ê²° ë¬¸ì œ");
        return;
    }
    
    // Step 3: ë¬¸ì œ ì¡°íšŒ
    const question = await testGetQuestion(sessionId);
    if (!question) {
        console.log("ğŸš¨ ë¬¸ì œ ì¡°íšŒ ì‹¤íŒ¨ - 789ê°œ ë¬¸ì œ ë°ì´í„° ì—°ê²° ë¬¸ì œ");
        return;
    }
    
    console.log("ğŸ‰ ëª¨ë“  API í…ŒìŠ¤íŠ¸ ì„±ê³µ!");
    console.log("ğŸ“‹ ë‹¤ìŒ ë‹¨ê³„: í”„ë¡ íŠ¸ì—”ë“œ JavaScript ì—°ê²° í™•ì¸");
}

// ì¦‰ì‹œ ì‹¤í–‰
runFullTest();

// 5. ìˆ˜ë™ í…ŒìŠ¤íŠ¸ìš© ê°œë³„ í•¨ìˆ˜ë“¤
window.testAPIHealth = testAPIHealth;
window.testQuizStart = testQuizStart;
window.testGetQuestion = testGetQuestion;
window.runFullTest = runFullTest;

console.log("ğŸ“‹ ìˆ˜ë™ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤ì´ window ê°ì²´ì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤:");
console.log("- testAPIHealth()");
console.log("- testQuizStart()");
console.log("- testGetQuestion(sessionId)");
console.log("- runFullTest()");