<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¬¸ì œ ë¡œë”© í…ŒìŠ¤íŠ¸ - ACIU S4</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- í—¤ë” -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-blue-600 mb-2">ë¬¸ì œ ë¡œë”© í…ŒìŠ¤íŠ¸</h1>
            <p class="text-gray-600">ACIU S4 ë¬¸ì œ ë¡œë”© ê¸°ëŠ¥ ì „ìš© í…ŒìŠ¤íŠ¸</p>
        </header>

        <!-- í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤ -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-2xl font-semibold mb-4">í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <button onclick="loadFirstQuestion()" class="bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-lg">
                    ğŸ”¢ ì²« ë²ˆì§¸ ë¬¸ì œ ë¡œë“œ
                </button>
                <button onclick="loadRandomQuestion()" class="bg-green-500 hover:bg-green-600 text-white p-4 rounded-lg">
                    ğŸ² ëœë¤ ë¬¸ì œ ë¡œë“œ
                </button>
                <button onclick="loadNextQuestion()" class="bg-purple-500 hover:bg-purple-600 text-white p-4 rounded-lg">
                    â¡ï¸ ë‹¤ìŒ ë¬¸ì œ ë¡œë“œ
                </button>
            </div>
        </div>

        <!-- ë¬¸ì œ í‘œì‹œ ì˜ì—­ -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-2xl font-semibold mb-4">ë¬¸ì œ í‘œì‹œ</h2>
            
            <!-- ë¬¸ì œ ì •ë³´ -->
            <div class="mb-4 p-4 bg-gray-50 rounded">
                <div class="flex justify-between items-center mb-2">
                    <span id="question-type" class="text-sm text-blue-600 font-medium">ì§„ìœ„í˜•</span>
                    <span id="question-code" class="text-sm text-gray-600">Q001</span>
                </div>
                <div id="layer-info" class="text-sm text-gray-500 mb-2">ì¬ì‚°ë³´í—˜ > ì¼ë°˜ì¬ì‚°ë³´í—˜</div>
                <div class="flex justify-between items-center mb-3">
                    <span class="text-sm text-gray-600">ì§„ë„</span>
                    <span id="progress-info" class="text-sm font-medium text-blue-600">1 / 789</span>
                </div>
                <div id="question-text" class="text-lg font-medium bg-red-100 p-4 rounded border-2 border-red-300">
                    ë¬¸ì œ í…ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                </div>
            </div>

            <!-- ë‹µì•ˆ ë²„íŠ¼ ì˜ì—­ -->
            <div id="answer-buttons" class="mb-4">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ë‹µì•ˆ ë²„íŠ¼ë“¤ -->
            </div>

            <!-- ì •ë‹µ í‘œì‹œ -->
            <div id="correct-answer" class="hidden p-4 bg-green-100 rounded border border-green-300">
                <h3 class="font-semibold text-green-800">ì •ë‹µ:</h3>
                <p id="correct-answer-text" class="text-green-700"></p>
            </div>
        </div>

        <!-- ë¡œê·¸ ì¶œë ¥ -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-semibold mb-4">í…ŒìŠ¤íŠ¸ ë¡œê·¸</h2>
            <div id="test-log" class="bg-gray-900 text-green-400 p-4 rounded font-mono text-sm h-64 overflow-y-auto">
                í…ŒìŠ¤íŠ¸ ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let questionsData = [];
        let currentQuestionIndex = 0;

        // ë¡œê·¸ ì¶œë ¥ í•¨ìˆ˜
        function log(message) {
            const logElement = document.getElementById('test-log');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        // JSON íŒŒì¼ ë¡œë“œ
        async function loadQuestions() {
            try {
                log('ğŸ“ JSON íŒŒì¼ ë¡œë”© ì‹œì‘...');
                const response = await fetch('/static/questions.json');
                
                if (!response.ok) {
                    throw new Error(`JSON íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: ${response.status}`);
                }
                
                const jsonData = await response.json();
                log(`âœ… JSON ë°ì´í„° ë¡œë“œ ì™„ë£Œ: ${jsonData.questions.length}ê°œ ë¬¸ì œ`);
                
                // ë°ì´í„° í•„í„°ë§
                questionsData = jsonData.questions.filter(question =>
                    question.qcode && question.question && question.answer && question.qcode.trim() !== ''
                );
                
                log(`âœ… í•„í„°ë§ ì™„ë£Œ: ${questionsData.length}ê°œ ë¬¸ì œ`);
                log('ğŸ¯ ë¬¸ì œ ë¡œë”© ì¤€ë¹„ ì™„ë£Œ!');
                
                return true;
            } catch (error) {
                log(`âŒ ë¬¸ì œ ë¡œë”© ì‹¤íŒ¨: ${error.message}`);
                return false;
            }
        }

        // ë¬¸ì œ í‘œì‹œ í•¨ìˆ˜
        function displayQuestion(index) {
            if (!questionsData || questionsData.length === 0) {
                log('âŒ ë¬¸ì œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (index >= questionsData.length) {
                log('âŒ ë¬¸ì œ ì¸ë±ìŠ¤ê°€ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¬ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const question = questionsData[index];
            log(`ğŸ“‹ ë¬¸ì œ ${index + 1} í‘œì‹œ: ${question.qcode}`);
            
            // ë¬¸ì œ ì •ë³´ í‘œì‹œ
            document.getElementById('question-code').textContent = question.qcode || 'Q???';
            document.getElementById('question-type').textContent = question.type || 'ì§„ìœ„í˜•';
            document.getElementById('layer-info').textContent = `${question.layer1 || ''} > ${question.layer2 || ''}`;
            document.getElementById('question-text').textContent = question.question || 'ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
            document.getElementById('progress-info').textContent = `${index + 1} / ${questionsData.length}`;
            
            // ë‹µì•ˆ ë²„íŠ¼ ìƒì„±
            createAnswerButtons(question);
            
            // ì •ë‹µ ìˆ¨ê¸°ê¸°
            document.getElementById('correct-answer').classList.add('hidden');
            
            log(`âœ… ë¬¸ì œ ${index + 1} í‘œì‹œ ì™„ë£Œ`);
        }

        // ë‹µì•ˆ ë²„íŠ¼ ìƒì„±
        function createAnswerButtons(question) {
            const buttonsContainer = document.getElementById('answer-buttons');
            buttonsContainer.innerHTML = '';
            
            if (question.type === 'ì§„ìœ„í˜•') {
                // O/X ë²„íŠ¼
                ['O', 'X'].forEach(answer => {
                    const button = document.createElement('button');
                    button.className = 'bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg mr-4 transition-all';
                    button.textContent = answer === 'O' ? 'â­• ë§ë‹¤ (O)' : 'âŒ í‹€ë¦¬ë‹¤ (X)';
                    button.onclick = () => showCorrectAnswer(question.answer);
                    buttonsContainer.appendChild(button);
                });
            } else {
                // ì„ íƒí˜• ë²„íŠ¼ (1, 2, 3, 4)
                for (let i = 1; i <= 4; i++) {
                    const button = document.createElement('button');
                    button.className = 'bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg mr-2 mb-2 transition-all';
                    button.textContent = `${i}ë²ˆ`;
                    button.onclick = () => showCorrectAnswer(question.answer);
                    buttonsContainer.appendChild(button);
                }
            }
            
            log(`âœ… ë‹µì•ˆ ë²„íŠ¼ ìƒì„± ì™„ë£Œ (${question.type})`);
        }

        // ì •ë‹µ í‘œì‹œ
        function showCorrectAnswer(correctAnswer) {
            document.getElementById('correct-answer-text').textContent = correctAnswer;
            document.getElementById('correct-answer').classList.remove('hidden');
            log(`âœ… ì •ë‹µ í‘œì‹œ: ${correctAnswer}`);
        }

        // ì²« ë²ˆì§¸ ë¬¸ì œ ë¡œë“œ
        function loadFirstQuestion() {
            currentQuestionIndex = 0;
            displayQuestion(currentQuestionIndex);
        }

        // ëœë¤ ë¬¸ì œ ë¡œë“œ
        function loadRandomQuestion() {
            if (questionsData.length > 0) {
                currentQuestionIndex = Math.floor(Math.random() * questionsData.length);
                displayQuestion(currentQuestionIndex);
            }
        }

        // ë‹¤ìŒ ë¬¸ì œ ë¡œë“œ
        function loadNextQuestion() {
            if (currentQuestionIndex < questionsData.length - 1) {
                currentQuestionIndex++;
                displayQuestion(currentQuestionIndex);
            } else {
                log('ğŸ‰ ë§ˆì§€ë§‰ ë¬¸ì œì…ë‹ˆë‹¤!');
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', async function() {
            log('ğŸš€ ë¬¸ì œ ë¡œë”© í…ŒìŠ¤íŠ¸ ì‹œì‘');
            const success = await loadQuestions();
            
            if (success) {
                log('âœ… ì´ˆê¸°í™” ì™„ë£Œ - ì²« ë²ˆì§¸ ë¬¸ì œë¥¼ ë¡œë“œí•´ë³´ì„¸ìš”!');
            } else {
                log('âŒ ì´ˆê¸°í™” ì‹¤íŒ¨');
            }
        });
    </script>
</body>
</html>
